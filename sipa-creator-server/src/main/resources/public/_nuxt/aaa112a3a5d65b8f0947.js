(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{450:function(e,t,n){"use strict";var o={props:["content"]},l=n(45),component=Object(l.a)(o,(function(){var e=this._self._c;return e("el-tooltip",{attrs:{content:this.content}},[e("i",{staticClass:"el-icon-question",staticStyle:{cursor:"hand"}})])}),[],!1,null,null,null);t.a=component.exports},452:function(e,t,n){"use strict";function o(e){var t=document.createElement("a"),n=window.URL.createObjectURL(e);t.href=n,t.download=decodeURI((new Date).getTime()+".zip"),t.style.display="none",document.body.appendChild(t),t.click(),t.parentNode.removeChild(t),window.URL.revokeObjectURL(n)}n.d(t,"a",(function(){return o}))},467:function(e,t,n){"use strict";n.r(t);n(57),n(100),n(72),n(73),n(141),n(142),n(236),n(3);var o=n(136),l=n.n(o),r=n(96),c=(n(58),n(71)),h=n.n(c),d=n(140),f=n.n(d),v=n(450),m=n(34),S=n(452);function w(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}var y={props:[],components:{HelpTip:v.a},data:function(){return{searchKey:"",showGenSettingDialog:!1,tables:[],choosedTables:[],genSetting:{author:"",choosedOutputFiles:[],override:!1,moduleName:"",choosedControllerMethods:[],rootPath:""},userConfig:{},outputFileInfos:[],isNewProject:!1,showSavedProjectsDialog:!1,savedProjects:[]}},computed:function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?w(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):w(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({isControllerChecked:function(){return!!this.genSetting.choosedOutputFiles&&-1!==this.genSetting.choosedOutputFiles.indexOf("Controller")},queryTables:function(){var e=this,t=[];return this.tables.forEach((function(n,i){!n.name||-1===n.name.toLowerCase().indexOf(e.searchKey.toLowerCase())&&e.searchKey||t.push(n)})),t}},Object(m.b)({tenant:function(e){return e.tenant}})),mounted:function(){this.getAllTables(this.tenant),this.getUserConfig(),this.getIsNewProject()},methods:{handleTableSelection:function(e){this.choosedTables=e.map((function(e){return e.name}))},getAllTables:function(e){var t=this;h.a.get("/api/db/tables",{params:{tenant:e}}).then((function(e){t.tables=e}))},getUserConfig:function(){var e=this;h.a.get("/api/output-file-info/user-config").then((function(t){e.userConfig=t}))},getIsNewProject:function(){var e=this;h.a.get("/api/output-file-info/check-if-new-project").then((function(t){e.isNewProject=t}))},openGenSetting:function(){var e=this;if(0!==this.choosedTables.length){try{var t=sessionStorage.getItem("gen-setting");t&&(f.a.assign(this.genSetting,JSON.parse(t)),this.genSetting.moduleName="",this.genSetting.override=!1),this.genSetting.rootPath||h.a.get("/api/output-file-info/project-root-path").then((function(t){e.genSetting.rootPath=t}))}catch(e){console.error(e)}this.showGenSettingDialog=!0}else this.$message.warning("请至少选择一张数据表")},genCode:function(){var e=this;this.$confirm("确认生成所选择的'"+this.choosedTables.length+"'张数据表的业务代码吗?","操作提示",{type:"warning"}).then((function(){var t=JSON.stringify(f.a.clone(e.genSetting));sessionStorage.setItem("gen-setting",t);var data={};data.tenant=e.tenant,data.genSetting=e.genSetting,data.tables=e.choosedTables;var n=l.a.service();h()({method:"post",url:"/api/mbp-generator/gen-code",data:data,responseType:"blob"}).then((function(t){Object(S.a)(t),e.$message({message:"业务代码已生成",type:"success"}),n.close(),e.showGenSettingDialog=!1,e.choosedTables=[],e.$refs.tableList.clearSelection()})).catch((function(){n.close()}))}))},openImportProjectView:function(){var e=this;this.showSavedProjectsDialog=!0,h.a.get("/api/output-file-info/all-saved-project").then((function(t){e.savedProjects=t}))},importProjectConfig:function(e){var t=this;this.$confirm("确定导入"+e+"的配置吗？").then((function(){h.a.post("/api/output-file-info/import-project-config/"+e).then((function(){t.$message.success("配置已导入"),t.showSavedProjectsDialog=!1,setTimeout((function(){window.location.reload()}),2)}))})).catch((function(){}))}},watch:{tenant:function(e){this.getAllTables(e),this.getUserConfig(),this.getIsNewProject()}}},_=n(45),component=Object(_.a)(y,(function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"content-header"}),e._v(" "),t("div",{staticClass:"content"},[t("div",{staticClass:"container"},[t("div",{staticStyle:{"margin-bottom":"10px"}},[t("el-input",{staticStyle:{width:"300px","margin-right":"20px"},attrs:{clearable:"",placeholder:"请输入表名进行查询","prefix-icon":"el-icon-search"},model:{value:e.searchKey,callback:function(t){e.searchKey=t},expression:"searchKey"}}),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:e.openGenSetting}},[e._v("代码生成")]),e._v(" "),e.isNewProject?t("span",{staticStyle:{color:"#e6a23c","font-size":"14px"}},[e._v("当前项目还没保存自定义配置，将使用默认配置。您也可以"),t("a",{attrs:{href:"#"},on:{click:e.openImportProjectView}},[e._v("导入")]),e._v("其它项目的配置，或者自定义\n          "),t("router-link",{attrs:{to:"/config"}},[e._v("配置")])],1):e._e()],1),e._v(" "),t("el-table",{ref:"tableList",staticStyle:{width:"100%"},attrs:{data:e.queryTables,border:""},on:{"selection-change":e.handleTableSelection}},[t("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),t("el-table-column",{attrs:{type:"index",width:"50",label:"序号"}}),e._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"name",label:"table名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.name))]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"comment",label:"table注释"}})],1)],1)]),e._v(" "),t("el-dialog",{attrs:{visible:e.showGenSettingDialog,title:"输出配置",width:"70%",top:"5vh"},on:{"update:visible":function(t){e.showGenSettingDialog=t}}},[t("el-form",{attrs:{"label-width":"220px"}},[t("el-form-item",{attrs:{label:"代码作者"}},[t("el-input",{staticStyle:{width:"260px"},model:{value:e.genSetting.author,callback:function(t){e.$set(e.genSetting,"author",t)},expression:"genSetting.author"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"功能模块名"}},[t("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"模块名将加入到输出包名之后，用于划分不同的模块"},model:{value:e.genSetting.moduleName,callback:function(t){e.$set(e.genSetting,"moduleName",t)},expression:"genSetting.moduleName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"本次需生成的文件"}},[t("el-checkbox-group",{model:{value:e.genSetting.choosedOutputFiles,callback:function(t){e.$set(e.genSetting,"choosedOutputFiles",t)},expression:"genSetting.choosedOutputFiles"}},e._l(e.userConfig.outputFiles,(function(n){return t("el-checkbox",{key:n.fileType,attrs:{label:n.fileType}},[e._v(e._s(n.fileType)+"\n          ")])})),1)],1),e._v(" "),e.isControllerChecked?t("el-form-item",{attrs:{label:"需生成的Controller方法"}},[t("el-alert",{attrs:{title:"注意：如果更换了Controller的模板，以下选项可能不会生效，需自行在模板中实现",type:"warning"}}),e._v(" "),t("el-checkbox-group",{model:{value:e.genSetting.choosedControllerMethods,callback:function(t){e.$set(e.genSetting,"choosedControllerMethods",t)},expression:"genSetting.choosedControllerMethods"}},[t("el-checkbox",{key:"list",attrs:{label:"list"}},[e._v("列表查询")]),e._v(" "),t("el-checkbox",{key:"getById",attrs:{label:"getById"}},[e._v("按ID查询")]),e._v(" "),t("el-checkbox",{key:"create",attrs:{label:"create"}},[e._v("新增")]),e._v(" "),t("el-checkbox",{key:"update",attrs:{label:"update"}},[e._v("修改")]),e._v(" "),t("el-checkbox",{key:"delete",attrs:{label:"delete"}},[e._v("删除")])],1)],1):e._e(),e._v(" "),t("el-form-item",{attrs:{label:"存在同名文件时是否覆盖"}},[t("el-switch",{model:{value:e.genSetting.override,callback:function(t){e.$set(e.genSetting,"override",t)},expression:"genSetting.override"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"目标项目根目录"}},[t("el-input",{staticStyle:{width:"400px"},attrs:{disabled:""},model:{value:e.genSetting.rootPath,callback:function(t){e.$set(e.genSetting,"rootPath",t)},expression:"genSetting.rootPath"}}),e._v(" "),t("help-tip",{attrs:{content:"最终生成的代码位置等于：目标项目根目录 + 具体某个类别的源码设置的包目录"}})],1),e._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.genCode()}}},[e._v("开始生成")])],1)],1)],1),e._v(" "),t("el-dialog",{attrs:{visible:e.showSavedProjectsDialog,title:"项目配置导入",width:"50%",top:"5vh"},on:{"update:visible":function(t){e.showSavedProjectsDialog=t}}},[t("el-table",{attrs:{data:e.savedProjects,height:"300px"}},[t("el-table-column",{attrs:{label:"项目包路径"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row)+"\n        ")]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"导入"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(t){return e.importProjectConfig(n.row)}}},[e._v("导入\n          ")])]}}])})],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports}}]);